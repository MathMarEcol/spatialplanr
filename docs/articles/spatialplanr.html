<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spatialplanr">
<title>A Basic Spatial Planning Workflow • spatialplanr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A Basic Spatial Planning Workflow">
<meta property="og:description" content="spatialplanr">
<meta property="og:image" content="https://mathmarecol.github.io/spatialplanr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spatialplanr</a>

    <small class="nav-text text-info me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/spatialplanr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Climate-smart_Workflow.html">Climate-Smart Spatial Planning</a>
    <a class="dropdown-item" href="../articles/MultipleUse_Examples.html">Spatial Planning With Zones</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MathMarEcol/spatialplanr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="spatialplanr_files/clipboard-1.7.1/clipboard.min.js"></script><link href="spatialplanr_files/primer-tooltips-1.4.0/build.css" rel="stylesheet">
<link href="spatialplanr_files/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">
<script src="spatialplanr_files/klippy-0.0.0.9500/js/klippy.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A Basic Spatial Planning Workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MathMarEcol/spatialplanr/blob/HEAD/vignettes/spatialplanr.Rmd" class="external-link"><code>vignettes/spatialplanr.Rmd</code></a></small>
      <div class="d-none name"><code>spatialplanr.Rmd</code></div>
    </div>

    
    
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MathMarEcol/spatialplanr" class="external-link">spatialplanr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This code has been written to simplify the process for running a
<em>prioritizr</em> analysis on a given region. It is still a work in
progress so feel free to submit pull requests with new features and code
improvements.</p>
<div class="section level3">
<h3 id="set-user-parameters">Set user parameters<a class="anchor" aria-label="anchor" href="#set-user-parameters"></a>
</h3>
<p>You can set a region if it is defined in
<code>splnr_get_planningUnits</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Region</span> <span class="op">&lt;-</span> <span class="st">"Coral Sea"</span> <span class="co"># "Australia"</span></span>
<span><span class="va">Type</span> <span class="op">&lt;-</span> <span class="st">"Oceans"</span> <span class="co"># "EEZ"</span></span></code></pre></div>
<p>You can also define a region with square boundaries if you need.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">150</span>, xmax <span class="op">=</span> <span class="fl">160</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">40</span>, ymax <span class="op">=</span> <span class="op">-</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p>Set the shape and area of the planning unit in square kilometres.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Shape</span> <span class="op">&lt;-</span> <span class="st">"Hexagon"</span> <span class="co"># "Shape of PUs</span></span>
<span><span class="va">PU_size</span> <span class="op">&lt;-</span> <span class="fl">10000</span> <span class="co"># km2</span></span></code></pre></div>
<p>Choose CRS for analysis. In this case we use Mollweide</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cCRS</span> <span class="op">&lt;-</span></span>
<span>  <span class="st">"+proj=moll +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-region">Analysis Region<a class="anchor" aria-label="anchor" href="#analysis-region"></a>
</h3>
<p>Start your analysis by defining your region and setting up the
planning units.</p>
<p>Get the boundary for your chosen region.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Bndry</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_get_boundary.html">splnr_get_boundary</a></span><span class="op">(</span><span class="va">Region</span>, <span class="va">Type</span>, <span class="va">cCRS</span><span class="op">)</span></span></code></pre></div>
<p>Get the land boundaries to remove overlap. The object “landmass”
represents the land mass that should be removed (inverse = FALSE)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">landmass</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span></span>
<span>  scale <span class="op">=</span> <span class="st">"medium"</span>,</span>
<span>  returnclass <span class="op">=</span> <span class="st">"sf"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">cCRS</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-planning-units">Create Planning Units<a class="anchor" aria-label="anchor" href="#create-planning-units"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PUs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_get_planningUnits.html">splnr_get_planningUnits</a></span><span class="op">(</span><span class="va">Bndry</span>, <span class="va">landmass</span>, <span class="va">PU_size</span>, <span class="va">Shape</span><span class="op">)</span></span></code></pre></div>
<p>We can check what the PUs look like</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggPU</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_PUs.html">splnr_plot_PUs</a></span><span class="op">(</span><span class="va">PUs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Plot Planning Units</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-9-1.png" width="864"></p>
<p>If we want to add additional properties to our map, for example
landmass or the boundary, we can use <code><a href="../reference/splnr_gg_add.html">splnr_gg_add()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggPU</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_PUs.html">splnr_plot_PUs</a></span><span class="op">(</span><span class="va">PUs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="st">"Default"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-10-1.png" width="864"></p>
<p>We can also use a customised <code>ggplpot</code> theme that can be
passed as a list to <code><a href="../reference/splnr_gg_add.html">splnr_gg_add()</a></code> and that can then be
used for all plots. For example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splnr_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    legend.direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>    text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">ggPU</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_PUs.html">splnr_plot_PUs</a></span><span class="op">(</span><span class="va">PUs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-11-1.png" width="864"></p>
</div>
<div class="section level3">
<h3 id="get-the-features">Get the features<a class="anchor" aria-label="anchor" href="#get-the-features"></a>
</h3>
<p>For our example, we will use a small subset of charismatic megafauna
species of the Coral Sea to inform the conservation plan. We filtered
the Aquamaps (Aquamaps.org) species distribution models for our study
area for the following species:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dict</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">Common</span>, <span class="op">~</span><span class="va">Scientific</span>, <span class="op">~</span><span class="va">TaxGroup</span>, <span class="op">~</span><span class="va">Category</span>,</span>
<span>  <span class="st">"Green sea turtle"</span>, <span class="st">"Chelonia_mydas"</span>, <span class="st">"Reptiles"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Loggerhead sea turtle"</span>, <span class="st">"Caretta_caretta"</span>, <span class="st">"Reptiles"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Hawksbill sea turtle"</span>, <span class="st">"Eretmochelys_imbricata"</span>, <span class="st">"Reptiles"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Olive ridley sea turtle"</span>, <span class="st">"Lepidochelys_olivacea"</span>, <span class="st">"Reptiles"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Saltwater crocodile"</span>, <span class="st">"Crocodylus_porosus"</span>, <span class="st">"Reptiles"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Humpback whale"</span>, <span class="st">"Megaptera_novaeangliae"</span>, <span class="st">"Mammals"</span>, <span class="st">"representative"</span>,</span>
<span>  <span class="st">"Common Minke whale"</span>, <span class="st">"Balaenoptera_acutorostrata"</span>,</span>
<span>  <span class="st">"Mammals"</span>, <span class="st">"representative"</span>, <span class="st">"Dugong"</span>, <span class="st">"Dugong_dugon"</span>, <span class="st">"Mammals"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Grey nurse shark"</span>, <span class="st">"Carcharias_taurus"</span>, <span class="st">"Sharks and rays"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Tiger shark"</span>, <span class="st">"Galeocerdo_cuvier"</span>, <span class="st">"Sharks and rays"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Great hammerhead shark"</span>, <span class="st">"Sphyrna_mokarran"</span>,</span>
<span>  <span class="st">"Sharks and rays"</span>, <span class="st">"representative"</span>,</span>
<span>  <span class="st">"Giant oceanic manta ray"</span>, <span class="st">"Mobula_birostris"</span>, <span class="st">"Sharks and rays"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Reef manta ray"</span>, <span class="st">"Mobula_alfredi"</span>, <span class="st">"Sharks and rays"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Whitetip reef shark"</span>, <span class="st">"Triaenodon_obesus"</span>, <span class="st">"Sharks and rays"</span>, <span class="st">"important"</span>,</span>
<span>  <span class="st">"Red-footed booby"</span>, <span class="st">"Sula_sula"</span>, <span class="st">"Birds"</span>, <span class="st">"important"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These species were not chosen based on their importance for this
region and only represent an example for visualization purposes.</p>
<p><strong>Note:</strong> The structure of the <code>tribble</code>above
is required for some of the downstream plotting. <em>Common</em> denotes
the common name of a species, <em>Scientific</em> the scientific name in
the format used by Aquamaps, <em>TaxGroup</em> is the taxonomic grouping
that a species belongs to and <em>Category</em> represents the
importance of the species for the conservation plan.</p>
<div class="section level4">
<h4 id="convert-the-probabilities-to-binary-data">Convert the probabilities to binary data<a class="anchor" aria-label="anchor" href="#convert-the-probabilities-to-binary-data"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datEx_species_bin</span> <span class="op">&lt;-</span> <span class="va">spDataFiltered</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/splnr_apply_cutoffs.html">splnr_apply_cutoffs</a></span><span class="op">(</span>Cutoffs <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>We can now look at the feature data used for the spatial plan
individually by calling <code><a href="../reference/splnr_plot_binFeature.html">splnr_plot_binFeature()</a></code>, for
example to see the binary habitat suitability map for Green sea
turtles:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggFeature1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_binFeature.html">splnr_plot_binFeature</a></span><span class="op">(</span></span>
<span>  <span class="va">datEx_species_bin</span>,</span>
<span>  <span class="va">datEx_species_bin</span><span class="op">$</span><span class="va">Chelonia_mydas</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-14-1.png" width="864"></p>
<p>The suitable habitat for Green sea turtles as predicted by Aquamaps
is restricted to few cells close to the coast. If we now compare this
with the predicted suitable habitat for Humpback whales, we can see that
they are fairly ubiquitous across the whole Coral Sea.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggFeature</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_binFeature.html">splnr_plot_binFeature</a></span><span class="op">(</span></span>
<span>  <span class="va">datEx_species_bin</span>,</span>
<span>  <span class="va">datEx_species_bin</span><span class="op">$</span><span class="va">Megaptera_novaeangliae</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-15-1.png" width="864"></p>
<p>In our example, this was the only reason why we classified species as
either representative if their suitable habitat is wide-ranging within
the study region or important if they are restricted to a few number of
cells.</p>
<p>To get a better idea of the overall distribution of the used
features, we can also plot the number of features with suitable habitat
within a planning unit of the study region.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggFeatNo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_featureNo.html">splnr_plot_featureNo</a></span><span class="op">(</span><span class="va">datEx_species_bin</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-16-1.png" width="864"></p>
</div>
<div class="section level4">
<h4 id="prepare-data-for-prioritisation">Prepare Data for prioritisation<a class="anchor" aria-label="anchor" href="#prepare-data-for-prioritisation"></a>
</h4>
<p>For the spatial prioritization we also need to extract the names of
our features to pass into <code>prioritizr</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_featureNames.html">splnr_featureNames</a></span><span class="op">(</span><span class="va">datEx_species_bin</span><span class="op">)</span></span></code></pre></div>
<p>We also create an <code>sf</code> object that contains all the
information needed for the prioritization.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_sf</span> <span class="op">&lt;-</span> <span class="va">datEx_species_bin</span></span></code></pre></div>
<div class="section level5">
<h5 id="add-cost">Add Cost<a class="anchor" aria-label="anchor" href="#add-cost"></a>
</h5>
<p>In our example, we use a minimum set objective function, which aims
to minimize the cost whilst meeting all the conservation targets. We add
an area-based cost to include as little area as possible in the spatial
plan whilst meeting the conservation targets. For this, all the planning
units are assigned an equal cost of 1.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_sf</span><span class="op">$</span><span class="va">Cost_None</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="op">(</span><span class="va">ggCost</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_cost.html">splnr_plot_cost</a></span><span class="op">(</span><span class="va">out_sf</span>, Cost_name <span class="op">=</span> <span class="st">"Cost_None"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-19-1.png" width="864"></p>
</div>
<div class="section level5">
<h5 id="set-targets">Set Targets<a class="anchor" aria-label="anchor" href="#set-targets"></a>
</h5>
<p>As shown previously, we assigned the conservation features a class
reflecting their importance in the planning region. Conservation targets
are then assigned a target based on their class, in our case 30% of
suitable habitat of important and 10% of representative features.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">catTarg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"important"</span> <span class="op">=</span> <span class="fl">0.3</span>, <span class="st">"representative"</span> <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">target</span> <span class="op">&lt;-</span> <span class="va">Dict</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/splnr_targets_byCategory.html">splnr_targets_byCategory</a></span><span class="op">(</span><span class="va">catTarg</span>, catName <span class="op">=</span> <span class="st">"Category"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> The assigned classes and targets were not
based on any ecological information and only chosen for visualization
purposes.</p>
</div>
</div>
<div class="section level4">
<h4 id="set-up-conservation-problem">Set up conservation problem<a class="anchor" aria-label="anchor" href="#set-up-conservation-problem"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datEx_problem</span> <span class="op">&lt;-</span> <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/problem.html" class="external-link">problem</a></span><span class="op">(</span><span class="va">out_sf</span>, <span class="va">feature_names</span>, <span class="st">"Cost_None"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_min_set_objective.html" class="external-link">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_relative_targets.html" class="external-link">add_relative_targets</a></span><span class="op">(</span><span class="va">target</span><span class="op">$</span><span class="va">target</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_binary_decisions.html" class="external-link">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_default_solver.html" class="external-link">add_default_solver</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="solve-the-conservation-problem">Solve the conservation problem<a class="anchor" aria-label="anchor" href="#solve-the-conservation-problem"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datEx_soln</span> <span class="op">&lt;-</span> <span class="va">datEx_problem</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/solve.html" class="external-link">solve.ConservationProblem</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="visualize-output">Visualize Output<a class="anchor" aria-label="anchor" href="#visualize-output"></a>
</h4>
<p>There are different ways to visualize the output of the
prioritization that can be loosely grouped into three categories:
<em>+</em> Visualization of the solution <em>+</em> Visualization of
targets <em>+</em> Visualization of importance scores</p>
<div class="section level5">
<h5 id="visualization-of-the-solution">Visualization of the solution<a class="anchor" aria-label="anchor" href="#visualization-of-the-solution"></a>
</h5>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggSoln</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_solution.html">splnr_plot_solution</a></span><span class="op">(</span><span class="va">datEx_soln</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-23-1.png" width="864"></p>
<p>This plot shows the optimal solution for the planning region that
meets the selected targets for the chosen features for the smallest area
possible. The categorical map displays, which of the planning units were
selected as important for meeting the conservation targets (dark blue)
and which were not selected (light blue). This can also be done with an
overlay of the cost to show how the solution avoids highly costly
areas:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggCostOverlay</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_costOverlay.html">splnr_plot_costOverlay</a></span><span class="op">(</span></span>
<span>  soln <span class="op">=</span> <span class="va">datEx_soln</span>,</span>
<span>  Cost <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Cost_name <span class="op">=</span> <span class="st">"Cost_None"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-24-1.png" width="864"></p>
<p><strong>Note:</strong> In our example, cost is equal for all planning
units.</p>
</div>
<div class="section level5">
<h5 id="visualization-of-targets">Visualization of targets<a class="anchor" aria-label="anchor" href="#visualization-of-targets"></a>
</h5>
<p>To visualize how well the targets are met, we first need to extract
how much suitable habitat of each feature are selected in the spatial
plan. This also includes potential incidental coverage of feature that
were not included in the spatial plan but can still be found in the
planning region.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfTarget</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_get_featureRep.html">splnr_get_featureRep</a></span><span class="op">(</span><span class="va">datEx_soln</span>, <span class="va">datEx_problem</span>,</span>
<span>  climsmart <span class="op">=</span> <span class="cn">FALSE</span>, solnCol <span class="op">=</span> <span class="st">"solution_1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">category</span> <span class="op">&lt;-</span> <span class="va">Dict</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"Scientific"</span>, <span class="st">"TaxGroup"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>feature <span class="op">=</span> <span class="st">"Scientific"</span>, category <span class="op">=</span> <span class="st">"TaxGroup"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="op">(</span><span class="va">ggTarget</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_featureRep.html">splnr_plot_featureRep</a></span><span class="op">(</span><span class="va">dfTarget</span>,</span>
<span>  category <span class="op">=</span> <span class="va">category</span>,</span>
<span>  nr <span class="op">=</span> <span class="fl">1</span>, showTarget <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-25-1.png" width="864"></p>
<p>For a circular bar plot, one additional step of data preparation
needs to be done.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># dfTargetCirc &lt;- dfTarget %&gt;%</span></span>
<span><span class="co"># dplyr::select("feature", "value", "group") %&gt;%</span></span>
<span><span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># colors &lt;- c(</span></span>
<span><span class="co">#   "important" = "darkgreen",</span></span>
<span><span class="co">#   "representative" = "darkred"</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># legends &lt;- c("Important", "Representative")</span></span>
<span></span>
<span><span class="co"># (ggCircTarg &lt;- splnr_plot_circBplot(df = dfTargetCirc, legend_list = legends, legend_color = colors, impTarget = 30, repTarget = 10))</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="visualization-of-importance-scores">Visualization of importance scores<a class="anchor" aria-label="anchor" href="#visualization-of-importance-scores"></a>
</h5>
<p>Importance scores can help to assess the relative importance of an
individual selected planning unit in the spatial plan (for more
information, see <a href="https://prioritizr.net/reference/importance.html" class="external-link uri">https://prioritizr.net/reference/importance.html</a>)</p>
<p>Here, we use two different importance scores, the Ferrier Score and
Rarity Weighted Richness.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ggFerrier</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_importanceScore.html">splnr_plot_importanceScore</a></span><span class="op">(</span></span>
<span>  soln <span class="op">=</span> <span class="va">datEx_soln</span>,</span>
<span>  pDat <span class="op">=</span> <span class="va">datEx_problem</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Ferrier"</span>,</span>
<span>  decimals <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  legendTitle <span class="op">=</span> <span class="st">"Importance Score \n(Ferrier Score)"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Ferrier Score.</span></span>
<span></span>
<span><span class="va">ggRWR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_importanceScore.html">splnr_plot_importanceScore</a></span><span class="op">(</span></span>
<span>  soln <span class="op">=</span> <span class="va">datEx_soln</span>,</span>
<span>  pDat <span class="op">=</span> <span class="va">datEx_problem</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"RWR"</span>,</span>
<span>  decimals <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  legendTitle <span class="op">=</span> <span class="st">"Importance Score \n(Rarity Weighted Richness)"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Rarity Wighted Richness.</span></span>
<span></span>
<span><span class="op">(</span><span class="va">ggScores</span> <span class="op">&lt;-</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">ggFerrier</span> <span class="op">+</span> <span class="va">ggRWR</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-27-1.png" width="864"></p>
<p>In our example, both scores label similar -coastal- planning units as
most important for the spatial plan.</p>
</div>
</div>
<div class="section level4">
<h4 id="comparing-spatial-plans">Comparing Spatial Plans<a class="anchor" aria-label="anchor" href="#comparing-spatial-plans"></a>
</h4>
<p>Sometimes it can be useful to have a direct comparison of two spatial
plans. To show how to achieve this with this package, we first need a
second conservation problem and resulting solution.</p>
<p>Here, our second spatial plan will include already existing marine
protected areas in the area (<a href="https://www.protectedplanet.net/en/thematic-areas/wdpa?tab=WDPA" class="external-link uri">https://www.protectedplanet.net/en/thematic-areas/wdpa?tab=WDPA</a>)
with the following characteristics: * Status = c(“Designated”,
“Established”, “Inscribed”) * Designation Type = c(“National”,
“Regional”, “International”, “Not Applicable”) * IUCN Category = c(“Ia”,
“Ib”, “II”, “III”, “IV”)</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The user can download their own MPAs using this code,</span></span>
<span><span class="co"># but below we use data already within the package.</span></span>
<span><span class="va">LockedIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_get_MPAs.html">splnr_get_MPAs</a></span><span class="op">(</span><span class="va">PUs</span>, <span class="st">"Australia"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/splnr_apply_cutoffs.html">splnr_apply_cutoffs</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>wdpa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">wdpa</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggMPA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_MPAs.html">splnr_plot_MPAs</a></span><span class="op">(</span><span class="va">MPAsCoralSea</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-29-1.png" width="864"></p>
<p>We will also include targets based on IUCN categories to prioritise
species with an IUCN status of:</p>
<ul>
<li>Vulnerable</li>
<li>Endangered</li>
<li>Critically Endangered</li>
<li>Extinct in the Wild</li>
<li>Extinct</li>
</ul>
<p>We assign a 30% target to species within these categories. All
species that do not fall into any of these categories receive an inverse
area target, so species with a greater area of suitable habitat are
assigned a lower target.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to transform Aquamaps species names to IUCN species names</span></span>
<span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">" "</span>, <span class="va">col_name</span><span class="op">)</span></span>
<span><span class="va">dfSpecies</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span></span>
<span></span>
<span><span class="va">minTarget</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">maxTarget</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span></span>
<span><span class="va">IUCN_IA_Targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_targets_byInverseArea.html">splnr_targets_byInverseArea</a></span><span class="op">(</span></span>
<span>  <span class="va">datEx_species_bin</span>,</span>
<span>  <span class="va">minTarget</span>,</span>
<span>  <span class="va">maxTarget</span></span>
<span><span class="op">)</span> <span class="co"># inverse area target</span></span>
<span></span>
<span><span class="va">IUCN_IA_Targets</span> <span class="op">&lt;-</span> <span class="va">Targets</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/splnr_get_IUCNRedList.html">splnr_get_IUCNRedList</a></span><span class="op">(</span>species_col <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># Add RL data to the df</span></span>
<span>  <span class="fu"><a href="../reference/splnr_targets_byIUCN.html">splnr_targets_byIUCN</a></span><span class="op">(</span>targ <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> Accessing the IUCN database requires a login
token from <code>rl_use_iucn()</code> that needs to be added to the
environment using
<code>Sys.setenv(IUCN_REDLIST_KEY = "[Your Token]")</code>. You can
start by running <code><a href="https://docs.ropensci.org/rredlist/reference/rl_use_iucn.html" class="external-link">rredlist::rl_use_iucn()</a></code>.</p>
<div class="section level5">
<h5 id="set-up-second-conservation-problem">Set up second conservation problem<a class="anchor" aria-label="anchor" href="#set-up-second-conservation-problem"></a>
</h5>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datEx_problem2</span> <span class="op">&lt;-</span> <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/problem.html" class="external-link">problem</a></span><span class="op">(</span><span class="va">out_sf</span>, <span class="va">feature_names</span>, <span class="st">"Cost_None"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_min_set_objective.html" class="external-link">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_relative_targets.html" class="external-link">add_relative_targets</a></span><span class="op">(</span><span class="va">IUCN_IA_Targets</span><span class="op">$</span><span class="va">Target</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_locked_in_constraints.html" class="external-link">add_locked_in_constraints</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">MPAsCoralSea</span><span class="op">$</span><span class="va">wdpa</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_binary_decisions.html" class="external-link">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_default_solver.html" class="external-link">add_default_solver</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a solution object</span></span>
<span><span class="va">datEx_soln2</span> <span class="op">&lt;-</span> <span class="va">datEx_problem2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/solve.html" class="external-link">solve.ConservationProblem</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">ggSoln2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_solution.html">splnr_plot_solution</a></span><span class="op">(</span><span class="va">datEx_soln2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-31-1.png" width="864"></p>
<p>But we locked in areas that were already existing MPAs. If we want to
show the overlap between the selected planning units and the current
MPAs, we can can add this to the
<code><a href="../reference/splnr_gg_add.html">splnr_gg_add()</a></code>function.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="../reference/splnr_plot_solution.html">splnr_plot_solution</a></span><span class="op">(</span><span class="va">datEx_soln2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, lockedInAreas <span class="op">=</span> <span class="va">MPAsCoralSea</span>,</span>
<span>    colInterest <span class="op">=</span> <span class="va">MPAsCoralSea</span><span class="op">$</span><span class="va">wdpa</span>, Type <span class="op">=</span> <span class="st">"Full"</span>,</span>
<span>    colorLI <span class="op">=</span> <span class="st">"lightgrey"</span>, alphaLI <span class="op">=</span> <span class="fl">0.2</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-32-1.png" width="864"></p>
<p>If we instead only want to see the contours of the locked in areas we
can set <code>Type = "Contours"</code>in
<code><a href="../reference/splnr_gg_add.html">splnr_gg_add()</a></code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="../reference/splnr_plot_solution.html">splnr_plot_solution</a></span><span class="op">(</span><span class="va">datEx_soln2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    lockedInAreas <span class="op">=</span> <span class="va">MPAsCoralSea</span>, colInterest <span class="op">=</span> <span class="va">MPAsCoralSea</span><span class="op">$</span><span class="va">wdpa</span>,</span>
<span>    Type <span class="op">=</span> <span class="st">"Contours"</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-33-1.png" width="864"></p>
</div>
<div class="section level5">
<h5 id="visualize-comparison">Visualize comparison<a class="anchor" aria-label="anchor" href="#visualize-comparison"></a>
</h5>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ggComp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_comparison.html">splnr_plot_comparison</a></span><span class="op">(</span><span class="va">datEx_soln</span>, <span class="va">datEx_soln2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-34-1.png" width="864"></p>
<p>This plot shows how the first solution (without current MPAs) differs
from the second solution (including current MPAs. The categorical map
displays, which of the planning units were selected in solution 2 but
not in solution 1 (red), in solution 1 but not in solution 2 (blue), or
selected in both solutions (grey).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CorrMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_get_kappaCorrData.html">splnr_get_kappaCorrData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">datEx_soln</span>, <span class="va">datEx_soln2</span><span class="op">)</span>,</span>
<span>  name_sol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"soln1"</span>, <span class="st">"soln2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">ggCorr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_corrMat.html">splnr_plot_corrMat</a></span><span class="op">(</span><span class="va">CorrMat</span>,</span>
<span>  AxisLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solution 1"</span>, <span class="st">"Solution 2"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-35-1.png" width="864"></p>
<p>The correlation matrix shows the similarity as the Cohen’s Kappa
correlation between solution 1 and solution 2.</p>
</div>
</div>
<div class="section level4">
<h4 id="plotting-selection-frequency">Plotting selection frequency<a class="anchor" aria-label="anchor" href="#plotting-selection-frequency"></a>
</h4>
<p>Sometimes when multiple spatial plans are generated, we are
interesting in how many times a planning unit is selected across the
array of solutions. To demonstrate how this can be done using this
package, we first create an array (= portfolio) of solutions. One
example of this is by using the portfolio</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datEx_soln_portfolio</span> <span class="op">&lt;-</span> <span class="va">datEx_problem</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_cuts_portfolio.html" class="external-link">add_cuts_portfolio</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># create a portfolio of solutions</span></span>
<span>  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/solve.html" class="external-link">solve.ConservationProblem</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">selFreq</span> <span class="op">&lt;-</span> <span class="va">datEx_soln_portfolio</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># calculate selection frequency</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>selFreq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"solution_"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">datEx_soln_portfolio</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">selFreq</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">ggselFreq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/splnr_plot_selectionFreq.html">splnr_plot_selectionFreq</a></span><span class="op">(</span><span class="va">selFreq</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/splnr_gg_add.html">splnr_gg_add</a></span><span class="op">(</span></span>
<span>    PUs <span class="op">=</span> <span class="va">PUs</span>, Bndry <span class="op">=</span> <span class="va">Bndry</span>, land <span class="op">=</span> <span class="va">landmass</span>,</span>
<span>    cropLand <span class="op">=</span> <span class="va">PUs</span>, ggtheme <span class="op">=</span> <span class="va">splnr_theme</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-36-1.png" width="864"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jason D. Everett, Sandra Neubert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
