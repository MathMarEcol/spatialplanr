<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Basic Spatial Planning Workflow • spatialplanr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A Basic Spatial Planning Workflow">
<meta property="og:description" content="spatialplanr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialplanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/spatialplanr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/PacificCentred.html">Pacific-Centred Spatial Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A Basic Spatial Planning Workflow</h1>
            
      
      
      <div class="hidden name"><code>spatialplanr.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spatialplanr</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This repository is specific to the work of the <a href="Mathematical%20Marine%20Ecology%20Lab">https://mathmarecol.github.io</a> at the University of Queensland. It is not intended to be used by anyone outside the MME Lab without the permission of Professor Anthony Richardson.</p>
<p>This code has been written to simplify the process for running a <em>prioritizr</em> analysis on a given region. It is still a work in progress so feel free to submit pull requests with new features and code improvements.</p>
<p>The code depends on <code>sf</code>, <code>terra</code>, <code>tidyverse</code>, <code>rnaturalearth</code>, <code>prioritizr</code>, <code>stars</code>, <code>patchwork</code>.</p>
<p>To use this code, you will need to download and expand <code>MME1DATA-Q1215/SpatialPlanning/Data.zip</code> to the directory <code>GitHub/SpatialPlanning/Data/</code>. Note that the download is only 2GB, but the expanded data is 35 GB in size. If you need help subsetting the data to your region due to memory or HD space constraints, contact Jason.</p>
<p>If you run into memory problems, you can try increasing the amount of the HD space gdal is allowed to use. <code>Sys.setenv(GDAL_MAX_BAND_COUNT = 120000)</code></p>
<div class="section level3">
<h3 id="preliminaries">Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h3>
<p>source(“SpatPlan_Process_AquaMaps.R”) # This script reprocesses AquaMaps. WARNING: Lots of time (10s hrs) and memory (10s GB) source(“SpatPlan_Process_MPAs.R”) # Only run if you need to reprocess the MPA data. You will need the WDPA files</p>
</div>
<div class="section level3">
<h3 id="set-user-parameters">Set user parameters<a class="anchor" aria-label="anchor" href="#set-user-parameters"></a>
</h3>
<p>You can set a region if it is defined in <code>SpatPlan_Get_PlanningUnits</code>. THe currently defined regions are: <code>Global</code>, <code>Australia</code>, <code>WestPacific</code>. If you need a new region, please submit a PR so others can benefit.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Region</span> <span class="op">&lt;-</span> <span class="st">"Australia"</span></code></pre></div>
<p>You can also define a region with square boundaries, which we will do here.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">150</span>, xmax <span class="op">=</span> <span class="fl">160</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">40</span>, ymax <span class="op">=</span> <span class="op">-</span><span class="fl">30</span><span class="op">)</span>
<span class="va">save_name</span> <span class="op">&lt;-</span> <span class="st">"SEAustralia"</span> <span class="co"># Name used in the saving</span></code></pre></div>
<p>Set the shape and area of the planning unit in square kilometres.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Shape</span> <span class="op">&lt;-</span> <span class="st">"Hexagon"</span> <span class="co"># "Shape of PUs</span>
<span class="va">PU_size</span> <span class="op">&lt;-</span> <span class="fl">5240</span> <span class="co"># km2 (~1 deg at equator)</span>
<span class="co"># PU_size &lt;- 2620 # km2 (0.5 deg at equator)</span>
<span class="co"># PU_size = 669.9 # km2 (0.25 deg at equator)</span>
<span class="co"># PU_size &lt;- 1000 # km2</span></code></pre></div>
<p>Set the depth range and probability cutoff (<code>CO</code>) for extracting AquaMaps data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MinDepth</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">MaxDepth</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">CO</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co">#Cutoff level for AquaMaps</span></code></pre></div>
<p>Set minimum and maximum limits for inverse area targets</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">minTarget</span> <span class="op">=</span> <span class="fl">0.2</span>
<span class="va">maxTarget</span> <span class="op">=</span> <span class="fl">0.5</span></code></pre></div>
<p>Choose CRS for analysis</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cCRS</span> <span class="op">&lt;-</span> <span class="st">"+proj=robin +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs"</span> <span class="co"># Robinson</span>
<span class="co"># cCRS &lt;- "+proj=robin +lon_0=180 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs" # Robinson: Pacific-centred</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis-region">Analysis Region<a class="anchor" aria-label="anchor" href="#analysis-region"></a>
</h3>
<p>Start your analysis by defining your region and setting up the planning units.</p>
<p>Get the boundary for your chosen region.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Bndry</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Get_Boundary.html">SpatPlan_Get_Boundary</a></span><span class="op">(</span><span class="va">Region</span>, <span class="va">cCRS</span><span class="op">)</span></code></pre></div>
<p>Get the land boundaries to remove overlap. The object “world” represents the land mass that should be removed (inverse = FALSE)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu">rnaturalearth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_countries.html" class="external-link">ne_countries</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"medium"</span>, returnclass <span class="op">=</span> <span class="st">"sf"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">cCRS</span><span class="op">)</span></code></pre></div>
<p>If Region = WestPacific, demarcating boundary and removing land areas would be different The object “world” here represents the planning region (inverse = TRUE)</p>
</div>
<div class="section level3">
<h3 id="create-planning-units">Create Planning Units<a class="anchor" aria-label="anchor" href="#create-planning-units"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PUs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Get_PlanningUnits.html">SpatPlan_Get_PlanningUnits</a></span><span class="op">(</span><span class="va">Bndry</span>, <span class="va">world</span>, <span class="va">PU_size</span>, <span class="va">Shape</span><span class="op">)</span>
<span class="co">#&gt; [1] "Range of cellsize are 5240 km2 to 5240 km2"</span></code></pre></div>
<p>We can check what the PUs look like</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">ggPU</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Plot_PUs.html">SpatPlan_Plot_PUs</a></span><span class="op">(</span><span class="va">PUs</span>, <span class="va">world</span><span class="op">)</span><span class="op">)</span> <span class="co"># Plot Planning Units</span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="get-the-features">Get the features<a class="anchor" aria-label="anchor" href="#get-the-features"></a>
</h3>
<div class="section level4">
<h4 id="aquamaps">Aquamaps<a class="anchor" aria-label="anchor" href="#aquamaps"></a>
</h4>
<p>Get aquamaps data for our species and region TODO Check the overlay of raw v processed species distribution If using Pacific-centered projection, define western and eastern limits west_limit = -120 # use negative numbers for western limit east_limit = 130 # use positive numbers for eastern limit</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aqua_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Get_AquaMaps.html">SpatPlan_Get_AquaMaps</a></span><span class="op">(</span><span class="va">PUs</span>, <span class="va">cCRS</span>, <span class="va">MinDepth</span>, <span class="va">MaxDepth</span>, CutOff <span class="op">=</span> <span class="va">CO</span><span class="op">)</span>
<span class="co">#&gt;       xmin       ymin       xmax       ymax </span>
<span class="co">#&gt; 107.932448 -47.978833 164.404230  -7.866356</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="iucn">IUCN<a class="anchor" aria-label="anchor" href="#iucn"></a>
</h4>
<p>TODO IUCN &lt;- fSpatPlan_Get_IUCN(PUs, cCRS)</p>
</div>
<div class="section level4">
<h4 id="mico">MICO<a class="anchor" aria-label="anchor" href="#mico"></a>
</h4>
<p>TODO MICO &lt;- fSpatPlan_Get_MICO(PUs, cCRS)</p>
</div>
<div class="section level4">
<h4 id="seafloor">Seafloor<a class="anchor" aria-label="anchor" href="#seafloor"></a>
</h4>
<p>TODO SeaFloor &lt;- fSpatPlan_Get_SeaFloor(PUs, cCRS)</p>
</div>
<div class="section level4">
<h4 id="geomorphic-features">Geomorphic features<a class="anchor" aria-label="anchor" href="#geomorphic-features"></a>
</h4>
<p>TODO GeoMorph &lt;- fSpatPlan_Get_GeoMorph(PUs, cCRS)</p>
</div>
<div class="section level4">
<h4 id="longhurst-provinces">Longhurst Provinces<a class="anchor" aria-label="anchor" href="#longhurst-provinces"></a>
</h4>
<p>You can also assign a Longhurst Province to each PU and set targets individually by province.Here we simply demonstrate this, but do not implement it into a spatial plan.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Longhurst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Match_Longhurst.html">SpatPlan_Match_Longhurst</a></span><span class="op">(</span><span class="va">PUs</span>, <span class="va">cCRS</span><span class="op">)</span>
<span class="co">#&gt; Reading layer `Longhurst_world_v4_2010' from data source </span>
<span class="co">#&gt;   `/Users/jason/SpatPlan_Data/LonghurstProvinces/Longhurst_world_v4_2010.shp' </span>
<span class="co">#&gt;   using driver `ESRI Shapefile'</span>
<span class="co">#&gt; Simple feature collection with 54 features and 2 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: -180 ymin: -78.50016 xmax: 180 ymax: 90</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="op">(</span><span class="va">ggLong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Plot_Longhurst.html">SpatPlan_Plot_Longhurst</a></span><span class="op">(</span><span class="va">Longhurst</span>, <span class="va">world</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="get-locked-in-areas">Get locked in areas<a class="anchor" aria-label="anchor" href="#get-locked-in-areas"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">LockedIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Get_MPAs.html">SpatPlan_Get_MPAs</a></span><span class="op">(</span><span class="va">PUs</span>, <span class="va">cCRS</span><span class="op">)</span>
<span class="op">(</span><span class="va">ggMPA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Plot_MPAs.html">SpatPlan_Plot_MPAs</a></span><span class="op">(</span><span class="va">LockedIn</span>, <span class="va">world</span><span class="op">)</span><span class="op">)</span> <span class="co"># Plot Locked in areas</span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="get-fisheries-cost">Get Fisheries cost<a class="anchor" aria-label="anchor" href="#get-fisheries-cost"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Get_FishCost.html">SpatPlan_Get_FishCost</a></span><span class="op">(</span><span class="va">PUs</span>, <span class="va">cCRS</span><span class="op">)</span>
<span class="op">(</span><span class="va">ggCost</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Plot_Cost.html">SpatPlan_Plot_Cost</a></span><span class="op">(</span><span class="va">Cost</span>, <span class="va">world</span><span class="op">)</span><span class="op">)</span> <span class="co"># Plot cost</span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="set-up-targets">Set up targets<a class="anchor" aria-label="anchor" href="#set-up-targets"></a>
</h3>
<div class="section level4">
<h4 id="identical-fixed-targets">Identical fixed targets<a class="anchor" aria-label="anchor" href="#identical-fixed-targets"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Targets</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="inverse-area-targets">Inverse area targets<a class="anchor" aria-label="anchor" href="#inverse-area-targets"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Get_TargetsIA.html">SpatPlan_Get_TargetsIA</a></span><span class="op">(</span><span class="va">aqua_sf</span>, <span class="va">minTarget</span>, <span class="va">maxTarget</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="add-different-targets-for-iucn-redlist-categories">Add different targets for IUCN RedList categories<a class="anchor" aria-label="anchor" href="#add-different-targets-for-iucn-redlist-categories"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">speciesCol</span> <span class="op">&lt;-</span> <span class="st">"Species"</span>
<span class="va">Targets</span> <span class="op">&lt;-</span> <span class="va">Targets</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/SpatPlan_Match_IUCNRedList.html">SpatPlan_Match_IUCNRedList</a></span><span class="op">(</span><span class="va">speciesCol</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># Add RL data to the df</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Target <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">IUCN_Category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EX"</span>,<span class="st">"EW"</span>,<span class="st">"CR"</span>,<span class="st">"EN"</span>,<span class="st">"VU"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,
                                          <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Targets</span><span class="op">$</span><span class="va">Target</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="set-up-the-planning-problem">Set up the planning problem<a class="anchor" aria-label="anchor" href="#set-up-the-planning-problem"></a>
</h3>
<div class="section level4">
<h4 id="get-the-list-of-features">Get the list of features<a class="anchor" aria-label="anchor" href="#get-the-list-of-features"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">features</span> <span class="op">&lt;-</span> <span class="va">aqua_sf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">out_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Cost</span>, <span class="va">LockedIn</span>, <span class="va">aqua_sf</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/problem.html" class="external-link">problem</a></span><span class="op">(</span><span class="va">out_sf</span>, <span class="va">features</span>, <span class="st">"Cost"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_min_set_objective.html" class="external-link">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_relative_targets.html" class="external-link">add_relative_targets</a></span><span class="op">(</span><span class="va">Targets</span><span class="op">$</span><span class="va">Target</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_locked_in_constraints.html" class="external-link">add_locked_in_constraints</a></span><span class="op">(</span><span class="st">"locked_in"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_binary_decisions.html" class="external-link">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_default_solver.html" class="external-link">add_default_solver</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="solve-the-planning-problem">Solve the planning problem<a class="anchor" aria-label="anchor" href="#solve-the-planning-problem"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>solution_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">solution_1</span><span class="op">)</span><span class="op">)</span> <span class="co"># Making it logical helps with the plotting #TODO move this to the plotting section?</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">ggSol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Plot_Solution.html">SpatPlan_Plot_Solution</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">PUs</span>, <span class="va">world</span><span class="op">)</span><span class="op">)</span> <span class="co"># Plot Solution</span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-21-1.png" width="672"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">ggFeatureNo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Plot_FeatureNo.html">SpatPlan_Plot_FeatureNo</a></span><span class="op">(</span><span class="va">aqua_sf</span>, <span class="va">world</span><span class="op">)</span> <span class="co"># Plot Number of features</span>

<span class="co">#+ echo=FALSE, fig.width=12</span>
<span class="op">(</span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ggPU</span>, <span class="va">ggMPA</span>, <span class="va">ggCost</span>, <span class="va">ggFeatureNo</span>, <span class="va">ggSol</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-21-2.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># ggsave(file.path("Figures", "Final_Solution.pdf"), plot = gg, height = 20, width = 40, units = "cm")</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-2-solutions">Compare 2 solutions<a class="anchor" aria-label="anchor" href="#compare-2-solutions"></a>
</h3>
<p>Here we run another problem/solution combo and compare the output with our original one. With a much lower target (30%), we expect less area set aside.</p>
<div class="section level4">
<h4 id="create-the-second-planning-problem">Create the second planning problem<a class="anchor" aria-label="anchor" href="#create-the-second-planning-problem"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/problem.html" class="external-link">problem</a></span><span class="op">(</span><span class="va">out_sf</span>, <span class="va">features</span>, <span class="st">"Cost"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_min_set_objective.html" class="external-link">add_min_set_objective</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_relative_targets.html" class="external-link">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.3</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_locked_in_constraints.html" class="external-link">add_locked_in_constraints</a></span><span class="op">(</span><span class="st">"locked_in"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_binary_decisions.html" class="external-link">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/add_default_solver.html" class="external-link">add_default_solver</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="solve-the-planning-problem-1">Solve the planning problem<a class="anchor" aria-label="anchor" href="#solve-the-planning-problem-1"></a>
</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu">prioritizr</span><span class="fu">::</span><span class="fu"><a href="https://prioritizr.net/reference/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>solution_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">solution_1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-comparison">Plot comparison<a class="anchor" aria-label="anchor" href="#plot-comparison"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SpatPlan_Plot_Comparison.html">SpatPlan_Plot_Comparison</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span>, <span class="va">world</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spatialplanr_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason Everett.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
